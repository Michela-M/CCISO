{
    "$schema": "https://docs.renovatebot.com/renovate-schema.json",
    "extends": ["config:base"],
    "lockFileMaintenance": { "enabled": true },
    "allowedPostUpgradeCommands": [
        "npm install",
        "if npm ci; then echo \"Installed with npm ci\"; else echo \"npm ci failed — falling back to npm install\"; npm install; fi",
        "if npm ci; then npm run build; else echo \"npm ci failed — falling back to npm install\"; npm install; npm run build; fi"
    ],
    "packageRules": [
        {
            "matchPackagePatterns": ["*"],
            "postUpgradeTasks": {
                "commands": [
                    "if npm ci; then echo \"Installed with npm ci\"; else echo \"npm ci failed — falling back to npm install\"; npm install; fi"
                ],
                "fileFilters": ["package-lock.json"]
            }
        }
    ]
}
